<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Super Nintendo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  height:100vh;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:white;
  font-family:Segoe UI,Arial;
  overflow:hidden;
}
#menu{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
}
.frame{
  background:#0b1220;
  padding:30px 50px;
  border-radius:26px;
  text-align:center;
}
.carousel{display:flex;gap:50px;}
.item{opacity:.4;transform:scale(.75);transition:.3s}
.item.active{opacity:1;transform:scale(1)}
.card img{max-width:220px;border-radius:12px}
.hint{opacity:.6;margin-top:15px}
#game{width:100vw;height:100vh;display:none}
</style>
</head>

<body tabindex="0">

<div id="menu">
  <div class="frame">
    <h1>SUPER NINTENDO</h1>
    <div id="carousel" class="carousel"></div>
    <div class="hint">⬅️ ➡️ elegir · ESPACIO jugar · Q volver</div>
  </div>
</div>

<div id="game"></div>

<script>
let games=[], selected=0, started=false;

fetch("roms.json")
.then(r=>r.json())
.then(d=>{
  games=d.snes.games;
  draw();
});

function draw(){
  const c=document.getElementById("carousel");
  c.innerHTML="";
  games.forEach((g,i)=>{
    c.innerHTML+=`
      <div class="item ${i===0?"active":""}">
        <div class="card"><img src="${g.cover}"></div>
        <div>${g.name}</div>
      </div>`;
  });
}

function redraw(){
  [...document.querySelectorAll(".item")]
  .forEach((e,i)=>e.classList.toggle("active",i===selected));
}

document.addEventListener("keydown",e=>{
  const k=e.key.toLowerCase();
  if(["arrowleft","arrowright"," "].includes(k)) e.preventDefault();

  if(!started){
    if(k==="arrowright"){selected=(selected+1)%games.length;redraw();}
    if(k==="arrowleft"){selected=(selected-1+games.length)%games.length;redraw();}
    if(k===" "){start();}
  }

  if(k==="q") location.href="index.html";
});

function start(){
  if(started) return;
  started=true;
  const g=games[selected];

  window.EJS_player="#game";
  window.EJS_core="snes";
  window.EJS_gameUrl=g.file;
  window.EJS_pathtodata="data/";
  window.EJS_startOnLoad=true;
  window.EJS_fullscreenOnStart=true;

  document.getElementById("menu").style.display="none";
  document.getElementById("game").style.display="block";

  const s=document.createElement("script");
  s.src="data/loader.js";
  document.body.appendChild(s);
}
</script>

</body>
</html>
